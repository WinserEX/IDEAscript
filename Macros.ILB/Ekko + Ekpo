
Sub Main  
    IgnoreWarning(true)
    'EKKO + EKPO
        Set db = Client.OpenDatabase("EKKO.IMD")
        Set task = db.JoinDatabase
        task.FileToJoin "EKPO.IMD"
        task.AddPFieldToInc "EBELN"
        task.AddPFieldToInc "BUKRS"
        task.AddPFieldToInc "LIFNR"
        task.AddPFieldToInc "WAERS"
        task.AddPFieldToInc "BEDAT"
        task.AddSFieldToInc "EBELN"
        task.AddSFieldToInc "TXZ01"
        task.AddSFieldToInc "MATNR"
        task.AddSFieldToInc "BUKRS"
        task.AddSFieldToInc "MEINS"
        task.AddSFieldToInc "NETPR"
        task.AddSFieldToInc "NETWR"
        task.AddSFieldToInc "BRTWR"
        task.AddMatchKey "EBELN", "EBELN", "A"
        task.CreateVirtualDatabase = False
        dbName = "EKKO + EKPO.IMD"
            task.PerformTask dbName, "", WI_JOIN_MATCH_ONLY
        Set task = Nothing
        Set db = Nothing

    '(EKKO + EKPO) + LFA1
        Set db = Client.OpenDatabase("EKKO + EKPO.IMD")
        Set task = db.JoinDatabase
        task.FileToJoin "LFA1.IMD"
        task.IncludeAllPFields
        task.AddSFieldToInc "NAME1"
        task.AddSFieldToInc "LIFNR"
        task.AddMatchKey "LIFNR", "LIFNR", "A"
        task.CreateVirtualDatabase = False
        dbName = "EKKO + EKPO + LFA1.IMD"
        task.PerformTask dbName, "", WI_JOIN_MATCH_ONLY
        Set task = Nothing
        Set db = Nothing

    Client.OpenDatabase (dbName)
End Sub


